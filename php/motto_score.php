<?php	header("Content-Type:text/html; charset=utf-8");    require_once dirname(__FILE__).'/pscws4.class.php';?><?php	function Calculate( $param ){		$q_ary = array();		$q_ary[] = $param;				$query = n_to_w( $param, 0 );		$pscws = new PSCWS4('utf8');		$pscws->set_dict('etc/dict_cht.utf8.xdb');		$pscws->set_rule('etc/rules.ini');		$pscws->send_text( $query );		$result = $pscws->get_result();  				$result_str = '';		$result_str_temp = '';		// 取得結果的所有詞彙		foreach( $result as $a ){			//$a['attr']			if( n_to_w( $a['word'], 1 ) != ' ' ){				if( (int)$a['idf'] != 0 ){					$result_str_temp = $result_str_temp.'+'.$a['word'];				}				$result_str = $result_str.'+'.$a['word'];			}		}		$result_str = n_to_w( $result_str, 1 );		$result_str_temp = n_to_w( $result_str_temp, 1 );		$q_ary[] = substr( $result_str, 1, strlen( $result_str ) );		if( empty($result_str_temp) )			$q_ary[] = substr( $result_str, 1, strlen( $result_str ) );		else			$q_ary[] = substr( $result_str_temp, 1, strlen( $result_str_temp ) );		$q_res = array();		for( $i=0; $i<3; $i++ ){			$ch = curl_init();			curl_setopt ($ch, CURLOPT_URL, 'http://www.google.com.tw/search?q='.urlencode( $q_ary[$i] ).'');			curl_setopt ($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1) Gecko/20061204 Firefox/2.0.0.1');			curl_setopt ($ch, CURLOPT_RETURNTRANSFER, true);			curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, 5);			curl_setopt ($ch, CURLOPT_AUTOREFERER, true);			curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, false);			curl_setopt ($ch, CURLOPT_SSL_VERIFYHOST, 2);			$html = curl_exec($ch);			curl_close($ch);						$matches = array();			preg_match('/"resultStats".*? (\S+)/', $html, $matches);			$q_res[] = $matches[1];		}		$test_ary = array();		$a = (int)str_replace( ',', '', $q_res[0] );		$b = (int)str_replace( ',', '', $q_res[1] );		$c = (int)str_replace( ',', '', $q_res[2] );		$d = ( $a/$b == $a/$c ) ? ( 0.5*$a/$b ) : ( $a/$b + $a/$c );		/*$e = ( $a/$b == $a/$c ) ? ( '(1/2)*0.5' ) : ( '1/2 + 1/3' );*/				return round( $d*10, 1 ).'*@*@*@'.$q_ary[2];	}?><?phpfunction n_to_w($strs, $types = '0'){  // narrow to wide , or wide to narrow    $nt = array(        "(", ")", "[", "]", "{", "}", ".", ",", ";", ":",        "-", "?", "!", "@", "#", "$", "%", "&", "|", "\\",        "/", "+", "=", "*", "~", "`", "'", "\"", "<", ">",        "^", "_",        "0", "1", "2", "3", "4", "5", "6", "7", "8", "9",        "a", "b", "c", "d", "e", "f", "g", "h", "i", "j",        "k", "l", "m", "n", "o", "p", "q", "r", "s", "t",        "u", "v", "w", "x", "y", "z",        "A", "B", "C", "D", "E", "F", "G", "H", "I", "J",        "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T",        "U", "V", "W", "X", "Y", "Z",        " "    );    $wt = array(        "（", "）", "〔", "〕", "｛", "｝", "﹒", "，", "；", "：",        "－", "？", "！", "＠", "＃", "＄", "％", "＆", "｜", "＼",        "／", "＋", "＝", "＊", "～", "、", "、", "＂", "＜", "＞",        "︿", "＿",        "０", "１", "２", "３", "４", "５", "６", "７", "８", "９",        "ａ", "ｂ", "ｃ", "ｄ", "ｅ", "ｆ", "ｇ", "ｈ", "ｉ", "ｊ",        "ｋ", "ｌ", "ｍ", "ｎ", "ｏ", "ｐ", "ｑ", "ｒ", "ｓ", "ｔ",        "ｕ", "ｖ", "ｗ", "ｘ", "ｙ", "ｚ",        "Ａ", "Ｂ", "Ｃ", "Ｄ", "Ｅ", "Ｆ", "Ｇ", "Ｈ", "Ｉ", "Ｊ",        "Ｋ", "Ｌ", "Ｍ", "Ｎ", "Ｏ", "Ｐ", "Ｑ", "Ｒ", "Ｓ", "Ｔ",        "Ｕ", "Ｖ", "Ｗ", "Ｘ", "Ｙ", "Ｚ",        "　"    );     if ($types == '0'){        // narrow to wide        $strtmp = str_replace($nt, $wt, $strs);    }else{        // wide to narrow        $strtmp = str_replace($wt, $nt, $strs);    }    return $strtmp;}?>